# LP Solver (Simplex Two-Phase)

Автор: Васильев А. Д.
Поток: К3340

Краткое описание
-----------------
Реализован симплекс-метод в двух фазах (Two-Phase Simplex) для решения задач линейного программирования в каноническом виде. Программа:
- читает задачу из текстового файла (формат указан ниже),
- приводит задачи к каноническому виду, добавляя необходимые добавочные переменные (slack/surplus и artificial),
- решает вспомогательную (фазу 1) задачу для нахождения допустимого базисного решения,
- при положительном результате фазы 1 удаляет искусственные переменные и переходит к фазе 2,
- печатает оптимальное решение (значения переменных и значение целевой функции) или сообщает о невозможности решения.

Алгоритм (кратко)
------------------
1. Разбор входных данных и формирование матрицы A, вектора b и коэффициентов целевой ф-ии c.
2. Для ограничений `<=` добавляется slack-переменная (с положительным 1). Для `>=` добавляются surplus (с -1) и искусственная(1). Для `=` добавляется искусственная переменная (1).
3. Формируется вспомогательная задача (минимизация суммы искусственных переменных),
   которая решается симплекс-методом. Если минимум > 0 => нет допустимого решения.
4. Если допустимое решение найдено — строится целевая функция основной задачи и решается методом симплекса.

Ограничения и допущения
------------------------
- Переменные предполагаются неотрицательными (x_i >= 0).
- Поддерживаются типы ограничений: `<=`, `>=`, `=`.
- Поддерживаются целевые функции `max` и `min` (входной файл указывает `objective max` или `objective min`).

Формат входного файла
---------------------
Строки:
- Первая строка: `objective max` или `objective min`.
- Вторая строка: коэффициенты целевой функции в виде `c a1 a2 ... an` (например `c 1 5 2 1`).
- Далее — по одной строке на ограничение, например `1 1 2 0 <= 6` или `2 0 0 1 >= 3`.

Пример файла `example1.lp`:
```
objective max
c 1 5 2 1
1 1 2 0 <= 6
0 1 1 1 = 4
2 0 0 1 >= 3
```

Как запускать
------------
В PowerShell:

```powershell
# запуск с примером по умолчанию (встроенных данных)
python .\lp_debug.py

# запуск с файлом данных
python .\lp_debug.py .\example1.lp
```

Готовый файл для сравнения с Excel
---------------------------------
1) Я уже подготовил рабочую книгу Excel (`lab1_lp_compare_ready.xlsx`) в папке `лаб1`.
2) Откройте `c:\Users\Arthur\Desktop\учеба\mo\лаб1\lab1_lp_compare_ready.xlsx`:
     - На листе `LP_Input` вы увидите заполненные переменные (B21..B24) — это значения, соответствующие нашему решению.
     - На листе `Comparison` вы увидите сравнение между нашим решением и значениями в Excel (обычно они совпадают, т.к. Excel переменные уже заполнены нашим решением).

Как обновить файл (если хотите пересчитать наши решения и снова сохранить):
```powershell
# из папки lab1
python .\update_excel_with_solution.py
```
 (Важно: запустите скрипт из папки `лаб1` или укажите корректный sys.path, чтобы импорт `lp_debug` работал.)

Проверка с Excel Solver (если хотите запустить Solver в Excel):
- Откройте `lab1_lp_compare_ready.xlsx`.
- Откройте Data → Solver.
- Set Objective: `LP_Input!$B$26` -> Max.
- By Changing Variable Cells: `LP_Input!$B$21:$B$24`.
- Add constraints (вкладка Add):
    - `LP_Input!$B$9:$E$9 <= LP_Input!$G$9`
    - `LP_Input!$B$10:$E$10 = LP_Input!$G$10`
    - `LP_Input!$B$11:$E$11 >= LP_Input!$G$11`
    - `LP_Input!$B$21:$B$24 >= 0`
- Choose Simplex LP method and press Solve.

После решения Excel заполнит `B21..B24` и вы увидите сравнение значений в листе `Comparison`.

Демонстрация работы
-------------------
Пример (встроенный):
- Оптимальное решение: x1 = 2, x2 = 4, x3 = 0, x4 = 0
- Значение целевой функции: 22

Рефлексия
---------
- Был исправлен ключевой баг: при построении целевой функции фазы 1 строку нужно формировать как *минус* сумма строк с искусственными переменными (для корректного представления редукции в форме симплекс-таблицы).
- Также добавлена защита против повторного ввода искусственных переменных в базис основной задачи (их нельзя допускать при выборе входящих переменных во второй фазе).
- Дальнейшие улучшения: удаление колонок искусственных переменных из таблицы после успешного выполнения фазы 1, реализация вывода подробной таблицы (для учебной отладки), добавление обработки неограниченных задач и лучшая поддержка исключительных ситуаций.

